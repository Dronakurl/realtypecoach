<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Monkeytype Injector V2</title>
    <style>
        body { font-family: monospace; padding: 40px; background: #1e1e1e; color: #e0e0e0; }
        .step { margin: 20px 0; padding: 15px; background: #2a2a2a; border-left: 4px solid #e2b714; }
        .error { color: #f44336; }
        .success { color: #4CAF50; }
        button { background: #e2b714; border: none; padding: 15px 30px; font-size: 16px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>üêµ Monkeytype Custom Text Injector</h1>

    <div class="step">
        <h3>Step 1: Inject into localStorage</h3>
        <p id="status">Click the button below to inject the text...</p>
        <button onclick="injectText()">üìù Inject German Text</button>
    </div>

    <div class="step">
        <h3>Step 2: Verify localStorage</h3>
        <p>Check the console (F12) to see what was stored.</p>
    </div>

    <div class="step">
        <h3>Step 3: Open Monkeytype</h3>
        <button onclick="openMonkeytype()">üîó Open monkeytype.com</button>
    </div>

    <script>
        const CUSTOM_TEXT = "Das Nilpferd in der Achterbahn";

        function injectText() {
            try {
                const words = CUSTOM_TEXT.split(/\s+/);
                const textName = 'rtc_' + Date.now();

                // Clear any old values
                localStorage.removeItem('customTextSettings');
                localStorage.removeItem('customTextName');
                localStorage.removeItem('customTextLong');
                localStorage.removeItem('customText');

                // Set custom text settings
                const customTextSettings = {
                    text: words,
                    mode: 'repeat',
                    limit: { value: words.length, mode: 'word' },
                    pipeDelimiter: false
                };

                localStorage.setItem('customTextSettings', JSON.stringify(customTextSettings));
                localStorage.setItem('customTextName', textName);
                localStorage.setItem('customTextLong', 'false');

                // Save to customText collection
                const customText = {};
                customText[textName] = CUSTOM_TEXT;
                localStorage.setItem('customText', JSON.stringify(customText));

                // Update config to custom mode
                let config = {};
                try {
                    config = JSON.parse(localStorage.getItem('config') || '{}');
                } catch(e) {}
                config.mode = 'custom';
                localStorage.setItem('config', JSON.stringify(config));

                console.log('‚úÖ Injection successful!');
                console.log('customTextSettings:', localStorage.getItem('customTextSettings'));
                console.log('config:', localStorage.getItem('config'));

                document.getElementById('status').innerHTML =
                    '<span class="success">‚úÖ Text injected successfully! Check console to verify.</span>';

            } catch (error) {
                console.error('‚ùå Injection failed:', error);
                document.getElementById('status').innerHTML =
                    '<span class="error">‚ùå Error: ' + error.message + '</span>';
            }
        }

        function openMonkeytype() {
            // Open in new tab
            window.open('https://monkeytype.com', '_blank');
        }

        // Auto-inject on page load
        setTimeout(() => {
            injectText();
        }, 500);
    </script>
</body>
</html>
